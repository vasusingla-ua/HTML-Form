<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Registration Form</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="form-container">
        <div class="form-header">
            <div class="form-title">Personal Info</div>
            <div class="form-subtitle">Update your personal details here</div>
        </div>
        <form id="registrationForm">
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" placeholder="Your name" required minlength="2">
            </div>

            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" placeholder="Your email address" required>
            </div>

            <div class="input-row">
                <div class="form-group">
                    <label for="age">Age</label>
                    <input type="number" id="age" name="age" placeholder="Your age" min="1" max="120" required>
                </div>
                <div class="form-group">
                    <label for="telephone">Phone no.</label>
                    <input type="tel" id="telephone" name="telephone" placeholder="Your phone no." required pattern="[0-9]{10,}" inputmode="numeric" autocomplete="tel">
                </div>
            </div>

            <div class="form-group">
                <label for="country">Country</label>
                <select id="country" name="country" required>
                    <option value="">Your country</option>
                    <option value="India">India</option>
                    <option value="USA">USA</option>
                    <option value="Japan">Japan</option>
                    <option value="China">China</option>
                </select>
            </div>

            <div class="form-group">
                <label>Gender</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="male" name="gender" value="Male" required>
                        <label for="male">Male</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="female" name="gender" value="Female">
                        <label for="female">Female</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="other" name="gender" value="Other">
                        <label for="other">Other</label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Tech Stack</label>
                <div class="tech-stack-wrapper">
                    <button type="button" class="tech-stack-button" id="techStackButton" >Your Tech Stack</button>
                    <div class="tech-stack-dropdown" id="techStackDropdown">
                        <label class="tech-checkbox">
                            <input type="checkbox" name="techStack" value="HTML"> HTML
                        </label>
                        <label class="tech-checkbox">
                            <input type="checkbox" name="techStack" value="CSS"> CSS
                        </label>
                        <label class="tech-checkbox">
                            <input type="checkbox" name="techStack" value="JS"> JS
                        </label>
                        <label class="tech-checkbox">
                            <input type="checkbox" name="techStack" value="React"> React
                        </label>
                        <label class="tech-checkbox">
                            <input type="checkbox" name="techStack" value="React Native"> React Native
                        </label>
                    </div>
                </div>
                <div id="techStackDisplay"></div>
            </div>

            <div class="form-group">
                <label for="address">Address</label>
                <textarea id="address" name="address" placeholder="Your address" required minlength="5"></textarea>
            </div>

            <div class="button-row">
                <button type="reset" id="resetBtn">Reset</button>
                <button type="submit" id="submitBtn">Submit</button>
            </div>
        </form>

        <div class="hidden" id="resultsSection">
            <h2>Submitted Information</h2>
            <table id="resultsTable">
                <thead>
                    <tr>
                        <th>Field</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="resultsBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Custom validation for email
        document.getElementById('email').addEventListener('invalid', function(e) {
            const emailPattern = /^[^\s@]+@[^\s@]+\.[a-zA-Z]{2,}$/;
            if (!emailPattern.test(this.value) || this.validity.valueMissing) {
                this.setCustomValidity('Enter a valid email address');
            } else {
                this.setCustomValidity('');
            }
        });
        document.getElementById('email').addEventListener('input', function(e) {
            this.setCustomValidity('');
        });

        // Custom validation for telephone
        document.getElementById('telephone').addEventListener('invalid', function(e) {
            if (this.validity.patternMismatch || this.validity.valueMissing) {
                this.setCustomValidity('Enter a valid phone number');
            } else {
                this.setCustomValidity('');
            }
        });
        document.getElementById('telephone').addEventListener('input', function(e) {
            this.setCustomValidity('');
        });

        // Form submission
        const form = document.getElementById('registrationForm');
        const resultsSection = document.getElementById('resultsSection');
        const resultsBody = document.getElementById('resultsBody');

        form.addEventListener('submit', function(e) {
            const techStackChecked = Array.from(document.querySelectorAll('input[name="techStack"]:checked')).map(el => el.value);
            
            if (techStackChecked.length === 0) {
                alert('Please select at least one technology in the Technological Stack.');
                e.preventDefault();
                return;
            }

            e.preventDefault();
            const techStackValues = techStackChecked.join(', ');
            const formData = [
                { field: 'Name', value: document.getElementById('name').value },
                { field: 'Age', value: document.getElementById('age').value },
                { field: 'Gender', value: document.querySelector('input[name="gender"]:checked').value },
                { field: 'Country', value: document.getElementById('country').value },
                { field: 'Technological Stack', value: techStackValues },
                { field: 'Address', value: document.getElementById('address').value },
                { field: 'Telephone', value: document.getElementById('telephone').value },
                { field: 'Email', value: document.getElementById('email').value }
            ];
            resultsBody.innerHTML = '';
            formData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${item.field}</td><td>${item.value}</td>`;
                resultsBody.appendChild(row);
            });
            resultsSection.classList.remove('hidden');
        });

        form.addEventListener('reset', function(e) {
            setTimeout(() => {
                updateTechStackDisplay();
                document.getElementById('techStackDropdown').classList.remove('open');
            }, 0);
        });

        // Tech Stack dropdown toggle
        const techStackButton = document.getElementById('techStackButton');
        const techStackDropdown = document.getElementById('techStackDropdown');
        const techStackDisplay = document.getElementById('techStackDisplay');
        const techStackCheckboxes = document.querySelectorAll('input[name="techStack"]');

        techStackButton.addEventListener('click', function(e) {
            e.preventDefault();
            techStackDropdown.classList.toggle('open');
        });

        function updateTechStackDisplay() {
            const selected = Array.from(techStackCheckboxes)
                .filter(cb => cb.checked)
                .map(cb => cb.value);
            
            techStackDisplay.innerHTML = '';
            selected.forEach(tech => {
                const tag = document.createElement('div');
                tag.textContent = tech;
                techStackDisplay.appendChild(tag);
            });

            // Update button text
            if (selected.length === 0) {
                techStackButton.textContent = 'Select Tech Stack';
            } else {
                techStackButton.textContent = selected.length + ' selected';
            }
        }

        techStackCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updateTechStackDisplay);
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.tech-stack-wrapper')) {
                techStackDropdown.classList.remove('open');
            }
        });
    </script>
</body>
</html>